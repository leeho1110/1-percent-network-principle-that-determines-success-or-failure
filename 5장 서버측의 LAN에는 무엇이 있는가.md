# 5장: 서버측의 LAN에는 무엇이 있는가?

### 1. 웹 서버의 설치 장소

- 우리가 요청을 보내는 서버는 과연 어떻게 설치되어 있을까요?
    - 먼저 간단하게는 라우터와 사내 LAN이 프로바이더의 네트워크로부터 액세스 회선을 통해 직접 연결될 수 있습니다.
        - 하지만 IP 주소 부족과 보안 문제로 인해 현재는 위 방법은 사용되지 않는 경우가 많습니다.
    - 따라서 최근엔 액세스 회선과 사내 LAN 사이에 방화벽을 두는 경우가 일반적입니다.
        - 방화벽은 패킷들을 검증하여 통과시키거나 차단하는 역할을 수행합니다.

---

### 2. 방화벽의 원리와 동작

- 방화벽은 기본적으로 특정 서버와 서버 내 특정 애플리케이션에 액세스하는 패킷은 통과시키고 나머지는 차단하는 방법을 사용합니다.
    - 네트워크 상에선 다양한 패킷이 흐르기 때문에 이를 구별해내는 것은 쉬운 일이 아닙니다. 이런 방법 중 **패킷 필터링형**이 가장 일반적입니다.
- 패킷 필터링에서는 아래와 같은 정보들을 통해 부정 패킷을 판단합니다.
    - 가장 먼저 수신처와 송신처 IP 주소를 통해 시작점과 끝점을 판단합니다.
    - 그 다음은 특정 애플리케이션에 대한 접근을 위해 포트 번호를 추가로 적용합니다.
    - TCP 커넥션을 위한 3way 핸드쉐이킹에서 매겨지는 컨트롤 비트도 활용합니다.
- 방화벽은 패킷을 판정하며 버린 패킷에 대한 기록을 남깁니다.
    - 버린 패킷을 통해 부정 침입의 흔적을 확인해 대책을 마련하기 위함입니다.
- 패킷 필터링만으론 패킷 내의 위험한 데이터 문제는 검증해내지 못합니다.

---

### 3. 복수 서버에 리퀘스트를 분배한 서버의 부하 분산

- 서버에 트래픽이 늘어날 때 서버의 성능을 증가시키는 것말고도 다른 방법이 존재합니다. 이 중 하나가 서버의 대수를 늘려 할당되는 요청의 처리를 나누어 처리하는 **분산 처리**입니다.
    - 가장 간단한 방법은 DNS 레벨에서 나누는 것입니다. DNS 서버에 같은 이름으로 여러 웹 서버의 IP를 등록하면 DNS 서버는 요청마다 **차례대로 IP 주소를 반환하는 라운드 로빈 방식으로 요청을 분배**합니다.
    - 하지만 이 방법은 서버의 페일 오버가 발생하더라도 해당 서버의 주소를 반환하기 때문에 온전한 고가용성을 보장하기 어렵습니다.
- 이를 보완하기 위해 등장한 방식이 바로 **로드 밸런서(Load balancer)** 입니다.
    - 이 방법에선 DNS 서버에 서버의 주소를 등록하지 않고 로드 밸런서의 주소를 등록하고, 이를 통해 요청이 분배되도록 합니다.

---